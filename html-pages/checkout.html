<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Checkout — Peptide Hub</title>
  <!-- Version: White Theme v2 -->
  <style>
    :root{
      --green:#1CB346;
      --green-d:#0f6b2b;
      --ink:#0f172a;
      --muted:#5b6472;
      --card:#ffffff;
      --radius:22px;
      --shadow:0 10px 30px rgba(0,0,0,.08);
      --border:#eef2f0;
    }
    *{box-sizing:border-box}
    html,body{margin:0;padding:0;background:#ffffff;color:var(--ink);font-family:ui-sans-serif,system-ui,-apple-system,Inter,Roboto,Arial}
    a{text-decoration:none;color:inherit}
    img{max-width:100%;display:block}
    /* Header */
    .header{position:sticky;top:0;z-index:20;background:linear-gradient(90deg,var(--green),var(--green-d));color:#fff;border-bottom:1px solid rgba(0,0,0,.04)}
    .nav{max-width:1000px;margin:0 auto;padding:14px 18px;display:flex;align-items:center;gap:18px}
    .nav img.logo{height:36px}
    .nav .spacer{flex:1}
    .nav a{font-weight:700;padding:10px 12px;border-radius:14px;color:#fff}
    .nav a:hover{background:rgba(255,255,255,.12)}
    /* Buttons */
    .btn{display:inline-block;background:var(--green);color:#fff;padding:12px 18px;border-radius:16px;font-weight:800;box-shadow:0 8px 20px rgba(28,179,70,.20);transition:.15s ease}
    .btn:hover{background:#17a03f;transform:translateY(-1px)}
    .btn-outline{background:#fff;color:var(--green);border:2px solid var(--green)}
    .container{max-width:1000px;margin:24px auto;padding:0 18px}
    /* Panels / Cards */
    .panel{background:#fff;border:1px solid var(--border);border-radius:22px;box-shadow:var(--shadow);padding:20px}
    .card{background:#fff;border:1px solid var(--border);border-radius:22px;box-shadow:var(--shadow);overflow:hidden;display:flex;flex-direction:column}
    .thumb{aspect-ratio:1.15/1;background:#f7faf8;display:flex;align-items:center;justify-content:center;padding:14px}
    .body{padding:14px 16px}
    .tag{display:inline-block;font-size:.75rem;font-weight:800;color:#0c3820;background:rgba(28,179,70,.12);padding:4px 8px;border-radius:999px}
    .title{font-size:1.05rem;font-weight:800;margin:8px 0 4px}
    .desc{color:var(--muted);font-size:.95rem;min-height:44px}
    .price{font-weight:800;margin:10px 0 12px}
    /* Footer */
    footer{max-width:1000px;margin:28px auto 44px;padding:0 18px;color:#334155}
    footer .legal{background:#f8faf9;padding:16px;border:1px solid #e6e9ee;border-radius:16px}
  </style>
</head>

<body>
  <header class="header">
    <nav class="nav">
      <a href="index.html"><img class="logo" src="assets/logo.png" alt="Peptide Hub logo" /></a>
      <div class="spacer"></div>
      <a href="index.html">Home</a>
      <a href="checkout.html">Checkout</a>
      <a href="legal.html">Legal</a>
    
      <a href="checkout.html" id="mini-cart-link">Cart (<span id="mini-cart-count">0</span>)</a>
      </nav>
  </header>

  <main class="container" style="margin-top:24px">
    <div class="panel">
      <h2 style="margin:6px 0 14px">Checkout</h2>
      <div style="display:grid;gap:18px;grid-template-columns:1.2fr .8fr">
        <section>
          <h3 style="margin:0 0 8px">Your Order</h3>
          <div style="border:1px solid var(--border);border-radius:22px;padding:12px"><div id="cart-list" style="display:flex;flex-direction:column;gap:8px"></div><div id="cart-total" style="display:flex;justify-content:space-between;padding:10px 0 0;font-weight:800"><span>Total</span><span id="total-val">$0.00</span></div></div>
        </section>

        <section>
          <h3 style="margin:0 0 8px">Choose a Payment Method</h3>
          <div style="display:grid;gap:14px;grid-template-columns:repeat(2,1fr)" id="paygrid">
            <div class="card pay" data-method="cashapp" style="cursor:pointer;display:flex;gap:12px;align-items:center;padding:14px;border-width:2px">
              <img style="width:48px;height:48px;object-fit:contain;border-radius:14px" src="assets/pay-cashapp.png" alt="Cash App">
              <div style="flex:1">
                <h4 style="margin:0 0 4px">Cash App</h4>
                <div style="font-size:.9rem;color:#256746">Estimated confirmation: <strong>0–6 hours</strong></div>
                <div style="font-size:.85rem;color:var(--muted)">Pay <strong>$PeptideCo</strong>. Put your order number in the note.</div>
              </div>
              <span class="radio" style="position:absolute;right:12px;top:12px;width:18px;height:18px;border:2px solid var(--green);border-radius:50%"></span>
            </div>
            <div class="card pay" data-method="venmo" style="cursor:pointer;display:flex;gap:12px;align-items:center;padding:14px;border-width:2px">
              <img style="width:48px;height:48px;object-fit:contain;border-radius:14px" src="assets/pay-venmo.png" alt="Venmo">
              <div style="flex:1">
                <h4 style="margin:0 0 4px">Venmo</h4>
                <div style="font-size:.9rem;color:#256746">Estimated confirmation: <strong>0–6 hours</strong></div>
                <div style="font-size:.85rem;color:var(--muted)">Pay <strong>@PeptideCo</strong>. Add your order number in memo.</div>
              </div>
              <span class="radio" style="position:absolute;right:12px;top:12px;width:18px;height:18px;border:2px solid var(--green);border-radius:50%"></span>
            </div>
            <div class="card pay" data-method="zelle" style="cursor:pointer;display:flex;gap:12px;align-items:center;padding:14px;border-width:2px">
              <img style="width:48px;height:48px;object-fit:contain;border-radius:14px" src="assets/pay-zelle.png" alt="Zelle">
              <div style="flex:1">
                <h4 style="margin:0 0 4px">Zelle</h4>
                <div style="font-size:.9rem;color:#256746">Estimated confirmation: <strong>0–24 hours</strong></div>
                <div style="font-size:.85rem;color:var(--muted)">Send to <strong>support@peptideco.com</strong>. Include order number.</div>
              </div>
              <span class="radio" style="position:absolute;right:12px;top:12px;width:18px;height:18px;border:2px solid var(--green);border-radius:50%"></span>
            </div>
            <div class="card pay" data-method="bitcoin" style="cursor:pointer;display:flex;gap:12px;align-items:center;padding:14px;border-width:2px">
              <img style="width:48px;height:48px;object-fit:contain;border-radius:14px" src="assets/pay-bitcoin.png" alt="Bitcoin">
              <div style="flex:1">
                <h4 style="margin:0 0 4px">Bitcoin</h4>
                <div style="font-size:.9rem;color:#256746">Estimated confirmation: <strong>~10–60 min</strong> (1–2 confirmations)</div>
                <div style="font-size:.85rem;color:var(--muted)">Send to your unique BTC address on next step.</div>
              </div>
              <span class="radio" style="position:absolute;right:12px;top:12px;width:18px;height:18px;border:2px solid var(--green);border-radius:50%"></span>
            </div>
          </div>
          <div style="margin-top:14px;display:flex;gap:10px;flex-wrap:wrap">
            <button class="btn" id="continue" disabled>Continue to Instructions</button>
            <a class="btn btn-outline" href="index.html">Back to Shop</a>
          </div>
        </section>
      </div>
    </div>
  </main>

  <footer>
    <div class="legal"><strong>Legal:</strong> For research purposes only. Not for human consumption. Must be 21+ to purchase.</div>
  </footer>

  <script>
    const cards = document.querySelectorAll('.pay');
    let selected = null;
    cards.forEach(c => {
      c.addEventListener('click', () => {
        cards.forEach(x => x.style.boxShadow='var(--shadow)');
        c.style.boxShadow='0 0 0 4px rgba(28,179,70,.12)';
        selected = c.dataset.method;
        document.getElementById('continue').disabled = false;
      });
    });
    document.getElementById('continue').addEventListener('click', () => {
      if(!selected) return;
      const orderId = 'PC' + Math.floor(100000 + Math.random()*900000);
      const total   = 409.98;
      const url = new URL('payment-instructions.html', window.location.href);
      url.searchParams.set('method', selected);
      url.searchParams.set('order', orderId);
      url.searchParams.set('total', total.toFixed(2));
      window.location.href = url.toString();
    });
  </script>

  <script>
    (function(){
      function fmt(n){ return '$' + n.toFixed(2); }
      function getCart(){ try{ return JSON.parse(localStorage.getItem('ph_cart')||'[]'); }catch(e){ return []; } }
      function saveCart(c){ localStorage.setItem('ph_cart', JSON.stringify(c)); }

      function render(){
        var cart = getCart();
        var list = document.getElementById('cart-list');
        var totalEl = document.getElementById('total-val');
        var cont = document.getElementById('continue');

        if(!list) return;

        list.innerHTML = '';
        var total = 0;
        if(cart.length === 0){
          list.innerHTML = '<div style="color:#5b6472;padding:8px">Your cart is empty. <a href="index.html#products" style="color:#1CB346;font-weight:800">Add products</a>.</div>';
          totalEl.textContent = fmt(0);
          if(cont) cont.disabled = true;
          return;
        }

        cart.forEach(function(item, idx){
          var line = document.createElement('div');
          line.style.display = 'flex';
          line.style.justifyContent = 'space-between';
          line.style.alignItems = 'center';
          line.style.padding = '8px 0';
          line.style.borderBottom = '1px dashed #e6e9ee';
          var left = document.createElement('div');
          left.textContent = item.name + ' — ' + item.size + ' × ' + item.qty;
          var right = document.createElement('div');
          var lineTotal = item.price * item.qty;
          right.textContent = fmt(lineTotal);
          total += lineTotal;

          // Remove link
          var rm = document.createElement('a');
          rm.href = '#';
          rm.textContent = 'Remove';
          rm.style.marginLeft = '12px';
          rm.style.fontWeight = '800';
          rm.style.color = '#b91c1c';
          rm.addEventListener('click', function(ev){
            ev.preventDefault();
            var c = getCart();
            c.splice(idx,1);
            saveCart(c);
            render();
          });

          // qty controls
          var minus = document.createElement('button');
          minus.textContent = '–';
          minus.style.marginLeft = '12px';
          minus.style.border = '1px solid #e6e9ee';
          minus.style.borderRadius = '8px';
          minus.style.padding = '2px 8px';
          minus.style.cursor = 'pointer';
          minus.addEventListener('click', function(){
            var c = getCart();
            if(c[idx].qty > 1){ c[idx].qty -= 1; } else { c.splice(idx,1); }
            saveCart(c); document.dispatchEvent(new Event('ph_cart_updated')); render();
          });

          var plus = document.createElement('button');
          plus.textContent = '+';
          plus.style.marginLeft = '6px';
          plus.style.border = '1px solid #e6e9ee';
          plus.style.borderRadius = '8px';
          plus.style.padding = '2px 8px';
          plus.style.cursor = 'pointer';
          plus.addEventListener('click', function(){
            var c = getCart();
            c[idx].qty += 1;
            saveCart(c); document.dispatchEvent(new Event('ph_cart_updated')); render();
          });

          var rightWrap = document.createElement('div');
          rightWrap.style.display='flex';
          rightWrap.style.alignItems='center';
          rightWrap.appendChild(right);
          rightWrap.appendChild(minus);
          rightWrap.appendChild(plus);
          rightWrap.appendChild(rm);

          line.appendChild(left);
          line.appendChild(rightWrap);
          list.appendChild(line);
        });

        totalEl.textContent = fmt(total);
        if(cont) cont.disabled = false;

        // Update Continue handler to pass correct total
        var btn = document.getElementById('continue');
        if(btn){
          btn.onclick = function(){
            // find selected method
            var selected = null;
            document.querySelectorAll('.pay').forEach(function(c){
              if(c.style.boxShadow && c.style.boxShadow.indexOf('4px')>-1) selected = c.dataset.method;
            });
            if(!selected){ alert('Please choose a payment method.'); return; }
            var orderId = 'PC' + Math.floor(100000 + Math.random()*900000);
            var url = new URL('payment-instructions.html', window.location.href);
            url.searchParams.set('method', selected);
            url.searchParams.set('order', orderId);
            url.searchParams.set('total', total.toFixed(2));
            window.location.href = url.toString();
          };
        }
      }

      // Mark selected payment with boxShadow like original code
      document.querySelectorAll('.pay').forEach(function(c){
        c.addEventListener('click', function(){
          document.querySelectorAll('.pay').forEach(x => x.style.boxShadow='var(--shadow)');
          c.style.boxShadow='0 0 0 4px rgba(28,179,70,.12)';
        });
      });

      document.addEventListener('DOMContentLoaded', render);
    })();
  </script>


<script>
(function(){
  function getCart(){ try{ return JSON.parse(localStorage.getItem('ph_cart')||'[]'); }catch(e){ return []; } }
  function countItems(){ return getCart().reduce(function(n,i){ return n + (i.qty||0); }, 0); }
  function renderMiniCart(){
    var span = document.getElementById('mini-cart-count');
    if(!span) return;
    span.textContent = countItems();
  }
  window.addEventListener('storage', function(e){ if(e.key === 'ph_cart') renderMiniCart(); });
  document.addEventListener('ph_cart_updated', renderMiniCart);
  document.addEventListener('DOMContentLoaded', renderMiniCart);
  // If an add-to-cart is clicked on this page, update count immediately
  document.addEventListener('click', function(e){
    var a = e.target && e.target.closest ? e.target.closest('.add-to-cart') : null;
    if(a){ setTimeout(function(){ document.dispatchEvent(new Event('ph_cart_updated')); }, 0); }
  });
})();
</script>

</body>
</html>
